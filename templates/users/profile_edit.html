{% extends 'mainpages/base.html' %}
{% load static %}
{% load i18n %}
{% load user_filters %}

{% block css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css">
<style>
/* ============================================================================
   SITE-WIDE THEME - Matching Home, Postings & All Pages
   ============================================================================ */
:root {
  /* Primary Blue - Matches Site Logo & Navbar */
  --primary-blue: #1e40af;
  --primary-blue-light: #3b82f6;
  --primary-blue-dark: #1e3a8a;
  --yellow: #fbbf24;
  --yellow-light: #fcd34d;
  --yellow-dark: #f59e0b;
  
  /* Site-Wide Gradients */
  --gradient-primary: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  --gradient-blue-yellow: linear-gradient(135deg, #1e40af 0%, #fbbf24 100%);
  --gradient-yellow-blue: linear-gradient(135deg, #fbbf24 0%, #3b82f6 100%);
  
  /* Main Theme Colors */
  --primary: #1e40af;
  --primary-dark: #1e3a8a;
  --primary-light: #3b82f6;
  --accent: #fbbf24;
  --accent-dark: #f59e0b;
  --success: #10b981;
  --danger: #ef4444;
  --info: #3b82f6;
  
  /* Rich Neutrals */
  --gray-50: #fafbfc;
  --gray-100: #f7f8fa;
  --gray-200: #e5e7eb;
  --gray-300: #d1d5db;
  --gray-400: #9ca3af;
  --gray-500: #6b7280;
  --gray-600: #4b5563;
  --gray-700: #374151;
  --gray-800: #1f2937;
  --gray-900: #111827;
  
  /* Premium Shadows with Depth */
  --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 2px 4px -1px rgba(0, 0, 0, 0.06), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  --shadow-colored: 0 8px 24px rgba(102, 126, 234, 0.25);
  
  /* Border Radius - Modern & Smooth */
  --radius-sm: 10px;
  --radius-md: 14px;
  --radius-lg: 18px;
  --radius-xl: 24px;
  
  /* Legacy Support */
  --primary-color: var(--primary);
  --primary-light: #e8ebfe;
  --success-color: var(--success);
  --warning-color: var(--accent);
  --danger-color: var(--danger);
  --text-dark: var(--gray-900);
  --text-medium: var(--gray-600);
  --text-light: var(--gray-500);
  --bg-light: var(--gray-50);
  --bg-white: #ffffff;
  --border-color: var(--gray-200);
  --accent-color: var(--accent);
}

body {
  background: #ffffff;
  min-height: 100vh;
  position: relative;
}

/* Animated Background Elements */
body::before {
  content: '';
  position: fixed;
  top: -50%;
  right: -20%;
  width: 800px;
  height: 800px;
  background: radial-gradient(circle, rgba(30, 64, 175, 0.05) 0%, transparent 70%);
  border-radius: 50%;
  animation: float 20s ease-in-out infinite;
  pointer-events: none;
}

body::after {
  content: '';
  position: fixed;
  bottom: -30%;
  left: -20%;
  width: 600px;
  height: 600px;
  background: radial-gradient(circle, rgba(251, 191, 36, 0.05) 0%, transparent 70%);
  border-radius: 50%;
  animation: float 15s ease-in-out infinite reverse;
  pointer-events: none;
}

@keyframes float {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  50% { transform: translate(30px, 30px) rotate(5deg); }
}

/* Header - Clean with Animation */
.edit-header {
  background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  padding: 2.5rem 0;
  margin-bottom: 2rem;
  box-shadow: 0 4px 20px rgba(30, 64, 175, 0.15);
  position: relative;
  overflow: hidden;
  animation: slideDown 0.5s ease-out;
}

@keyframes slideDown {
  from { transform: translateY(-100%); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

.edit-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.3), transparent);
  animation: shine 3s ease-in-out infinite;
}

@keyframes shine {
  0% { left: -100%; }
  50%, 100% { left: 100%; }
}

.edit-header .container {
  position: relative;
  z-index: 2;
}

.edit-header h1 {
  color: white !important;
  font-size: 2.25rem;
  font-weight: 700;
  margin: 0 0 0.5rem 0;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  letter-spacing: -0.02em;
  position: relative;
  z-index: 1;
}

.edit-header h1 i {
  color: var(--yellow) !important;
  font-size: 2rem;
  animation: bounce 2s ease-in-out infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}

.edit-header p {
  color: rgba(255, 255, 255, 0.95) !important;
  margin: 0;
  font-size: 1.125rem;
  font-weight: 400;
  position: relative;
  z-index: 1;
}

/* Form Container */
.form-container-edit {
  max-width: 1200px;
  margin: 0 auto 3rem;
  background: white;
  border-radius: 16px;
  box-shadow: var(--shadow-lg);
  overflow: hidden;
}

/* Form Layout */
.form-layout-edit {
  display: grid;
  grid-template-columns: 350px 1fr;
  gap: 0;
}

.form-sidebar-edit {
  background: var(--bg-light);
  padding: 2rem;
  border-right: 1px solid var(--border-color);
}

.form-main-edit {
  padding: 2rem;
}

/* Clean Animated Cards */
.section-edit {
  margin-bottom: 2rem;
  background: white;
  border-radius: 16px;
  padding: 0;
  border: 2px solid #f0f0f0;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  position: relative;
  max-width: 100%;
  animation: fadeInUp 0.6s ease-out backwards;
}

/* Collapsible Section Styles - DISABLED */
/* All sections are now always visible */

.section-edit:nth-child(1) { animation-delay: 0.1s; }
.section-edit:nth-child(2) { animation-delay: 0.2s; }
.section-edit:nth-child(3) { animation-delay: 0.3s; }
.section-edit:nth-child(4) { animation-delay: 0.4s; }
.section-edit:nth-child(5) { animation-delay: 0.5s; }

@keyframes fadeInUp {
  from { 
    opacity: 0;
    transform: translateY(30px);
  }
  to { 
    opacity: 1;
    transform: translateY(0);
  }
}

.section-edit::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, var(--primary) 0%, var(--yellow) 100%);
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.5s ease;
}

.section-edit:hover {
  box-shadow: 0 12px 32px rgba(30, 64, 175, 0.15);
  transform: translateY(-4px);
  border-color: var(--primary);
}

.section-edit:hover::before {
  transform: scaleX(1);
}

.section-title-edit {
  font-size: 1.375rem;
  font-weight: 700;
  color: white;
  margin: 0;
  padding: 1.75rem 2rem;
  display: flex;
  align-items: center;
  gap: 1rem;
  background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  border-bottom: 2px solid #1e40af;
  position: relative;
  cursor: default;
  user-select: none;
}

.section-title-edit:hover {
  background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
}

.section-title-edit i {
  color: #fbbf24;
}

.section-title-edit::after {
  content: '';
  position: absolute;
  left: 0;
  bottom: -2px;
  width: 0;
  height: 3px;
  background: linear-gradient(90deg, #fbbf24 0%, #f59e0b 50%, #fbbf24 100%);
  transition: width 0.5s ease;
  box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
}

.section-edit:hover .section-title-edit::after {
  width: 100%;
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% {
    background-position: -100% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.section-title-edit i {
  font-size: 1.5rem;
  color: #fbbf24;
  animation: iconGlow 3s ease-in-out infinite;
  filter: drop-shadow(0 0 3px rgba(251, 191, 36, 0.3));
}

@keyframes iconGlow {
  0%, 100% { 
    transform: scale(1);
    filter: drop-shadow(0 0 3px rgba(251, 191, 36, 0.3));
  }
  50% { 
    transform: scale(1.1);
    filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.6));
  }
}

.section-edit .section-content {
  padding: 2rem 2.5rem 2.5rem 2.5rem;
}

/* Add padding to form groups inside sections */
.section-edit > .form-group-edit,
.section-edit > .form-row-edit,
.section-edit > div:not(.section-title-edit) {
  padding-left: 2.5rem;
  padding-right: 2.5rem;
}

.section-edit > .form-group-edit:last-child {
  padding-bottom: 2rem;
}

@media (max-width: 768px) {
  .section-edit .section-content {
    padding: 1.5rem 2rem;
  }
  
  .section-edit > .form-group-edit,
  .section-edit > .form-row-edit,
  .section-edit > div:not(.section-title-edit) {
    padding-left: 2rem;
    padding-right: 2rem;
  }
}

/* Consistent Professional Theme */
.section-edit .section-title-edit {
  background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%) !important;
  color: white !important;
}

.section-edit .section-title-edit i {
  color: #fbbf24 !important;
}

/* Form Groups */
.form-group-edit {
  margin-bottom: 1.5rem;
  width: 100%;
}

.form-label-edit {
  display: block;
  font-weight: 700;
  color: var(--gray-800);
  margin-bottom: 0.625rem;
  font-size: 0.9375rem;
  letter-spacing: -0.01em;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.form-label-edit i {
  color: var(--primary);
  font-size: 1.125rem;
  opacity: 0.85;
}

.form-control-edit {
  width: 100%;
  padding: 0.875rem 1.25rem !important;
  border: 1.5px solid #e5e7eb;
  border-radius: 10px;
  font-size: 0.9375rem;
  transition: all 0.3s ease;
  background: white;
  color: var(--gray-900);
  font-weight: 400;
  line-height: 1.5;
}

/* Slick and Elegant Form Controls */
input.form-control-edit,
select.form-control-edit,
textarea.form-control-edit,
input[type="text"].form-control-edit,
input[type="email"].form-control-edit,
input[type="tel"].form-control-edit,
input[type="date"].form-control-edit {
  padding: 0.875rem 1.25rem !important;
  font-size: 0.9375rem;
  border-radius: 10px;
  border: 1.5px solid #e5e7eb;
}

.form-control-edit:hover {
  border-color: #cbd5e1;
  background: white;
}

.form-control-edit:focus {
  outline: none;
  border-color: var(--primary);
  background: white;
  box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

.form-control-edit:disabled {
  background: var(--gray-100);
  cursor: not-allowed;
  opacity: 0.7;
  border-color: var(--gray-200);
}

/* Required field indicator - Yellow Badge */
.form-label-edit span[style*="color: #dc3545"],
.form-label-edit span[style*="color:#dc3545"] {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--yellow) !important;
  color: var(--royal-blue-dark) !important;
  padding: 3px 8px;
  border-radius: 6px;
  font-size: 0.6875rem;
  font-weight: 700;
  letter-spacing: 0.02em;
  box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
  margin-left: auto;
}

/* Hide required indicators for address fields, education, and experience */
label[for="id_province"] span[style*="color: #dc3545"],
label[for="id_city"] span[style*="color: #dc3545"],
label[for="id_barangay"] span[style*="color: #dc3545"],
label[for="id_zip_code"] span[style*="color: #dc3545"] {
  display: none !important;
}

/* Hide yellow asterisks in Education and Experience sections */
.education-section .form-label-edit span[style*="color: #dc3545"],
.experience-section .form-label-edit span[style*="color: #dc3545"],
.education-form .form-label-edit span[style*="color: #dc3545"],
.experience-form .form-label-edit span[style*="color: #dc3545"] {
  display: none !important;
}

textarea.form-control-edit {
  min-height: 150px;
  resize: vertical;
  font-family: inherit;
  width: 100%;
}

select.form-control-edit {
  width: 100%;
}

.form-text-edit {
  font-size: 0.85rem;
  color: var(--gray-500);
  margin-top: 0.5rem;
  display: flex;
  align-items: center;
  gap: 0.35rem;
  padding: 0.5rem 0.75rem;
  background: var(--gray-50);
  border-radius: 8px;
  border-left: 3px solid var(--primary);
}

.form-text-edit i {
  font-size: 0.9rem;
  color: var(--primary);
}

/* Helper text variants */
small.form-text {
  display: inline-block;
  padding: 0.35rem 0.75rem;
  background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
  border-radius: 6px;
  border-left: 3px solid #3b82f6;
  color: #1e40af;
  font-weight: 500;
}

small[style*="color: #6c757d"] {
  background: linear-gradient(135deg, #f9fafb 0%, #f3f4f6 100%);
  border-left-color: #9ca3af;
  color: #4b5563 !important;
}

.text-danger {
  color: var(--danger-color);
  font-size: 0.875rem;
  margin-top: 0.5rem;
}

/* CV Upload Styles */
.current-cv-display {
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
  border: 2px solid #e2e8f0;
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
}

.cv-file-info {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin-bottom: 1rem;
  flex-wrap: wrap;
}

.cv-file-details {
  flex: 1;
  min-width: 0;
}

.cv-file-name {
  font-weight: 600;
  color: var(--text-dark);
  margin-bottom: 0.25rem;
  word-break: break-word;
  overflow-wrap: break-word;
}

.cv-file-date {
  font-size: 0.85rem;
  color: var(--text-light);
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.5rem;
}

.btn-cv-preview {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  color: white;
  border-radius: 8px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.875rem;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
  white-space: nowrap;
}

.btn-cv-preview:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.cv-replace-note {
  font-size: 0.85rem;
  color: var(--text-light);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem;
  background: rgba(59, 130, 246, 0.05);
  border-left: 3px solid #3b82f6;
  border-radius: 6px;
  margin: 0;
}

.cv-upload-wrapper {
  margin-top: 1rem;
}

.cv-upload-wrapper input[type="file"] {
  display: block;
  width: 100%;
  padding: 0.75rem;
  border: 2px dashed var(--border-color);
  border-radius: 8px;
  background: var(--bg-light);
  cursor: pointer;
  transition: all 0.3s ease;
}

.cv-upload-wrapper input[type="file"]:hover {
  border-color: var(--primary-color);
  background: rgba(59, 130, 246, 0.05);
}

.cv-upload-wrapper input[type="file"]:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* Form Row */
.form-row-edit {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
}

/* Profile Picture Upload */
.profile-pic-upload {
  display: flex;
  align-items: center;
  gap: 1.5rem;
  padding: 1.5rem;
  background: var(--bg-light);
  border-radius: 12px;
  border: 2px dashed var(--border-color);
}

.current-profile-pic {
  width: 100px;
  height: 100px;
  border-radius: 50%;
  object-fit: cover;
  border: 4px solid white;
  box-shadow: var(--shadow-md);
}

.pic-upload-content {
  flex: 1;
}

.pic-upload-title {
  font-weight: 600;
  color: var(--text-dark);
  margin-bottom: 0.5rem;
}

.pic-upload-hint {
  font-size: 0.85rem;
  color: var(--text-light);
  margin-bottom: 1rem;
}

/* Cover Photo Selector */
.cover-photo-selector {
  padding: 1.5rem;
  background: var(--bg-light);
  border-radius: 12px;
  border: 2px solid var(--border-color);
}

.cover-options-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.cover-option {
  position: relative;
  cursor: pointer;
}

.cover-option input[type="radio"] {
  position: absolute;
  opacity: 0;
}

.cover-preview {
  height: 80px;
  border-radius: 10px;
  border: 3px solid transparent;
  transition: all 0.3s;
  position: relative;
  overflow: hidden;
}

.cover-option input[type="radio"]:checked + .cover-preview {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 3px rgba(26, 148, 212, 0.2);
  transform: scale(1.05);
}

.cover-preview::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) scale(0);
  width: 30px;
  height: 30px;
  background: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.cover-option input[type="radio"]:checked + .cover-preview::after {
  content: 'âœ“';
  transform: translate(-50%, -50%) scale(1);
  color: var(--primary-color);
  font-weight: bold;
  font-size: 1.2rem;
  line-height: 30px;
  text-align: center;
}

.cover-label {
  text-align: center;
  font-size: 0.85rem;
  color: var(--text-medium);
  margin-top: 0.5rem;
  font-weight: 500;
}

.gradient-1 {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.gradient-2 {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}

.gradient-3 {
  background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
}

.gradient-4 {
  background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
}

.gradient-5 {
  background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
}

.gradient-6 {
  background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);
}

.custom-cover-upload {
  padding: 1.5rem;
  border: 2px dashed var(--border-color);
  border-radius: 10px;
  text-align: center;
  transition: all 0.3s;
}

.custom-cover-upload:hover {
  border-color: var(--primary-color);
  background: var(--primary-light);
}

.upload-icon-large {
  font-size: 2.5rem;
  color: var(--primary-color);
  margin-bottom: 0.75rem;
}

/* Education/Experience Forms */
.formset-item {
  background: linear-gradient(to bottom, #ffffff 0%, #fafbfc 100%);
  border: 2px solid var(--gray-200);
  border-radius: var(--radius-md);
  padding: 1.5rem;
  margin-bottom: 1.25rem;
  position: relative;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: var(--shadow-xs);
}

.formset-item:hover {
  border-color: var(--primary);
  box-shadow: var(--shadow-md);
  transform: translateY(-2px);
}

.formset-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border-color);
}

.formset-title {
  font-weight: 600;
  color: var(--text-dark);
}

.formset-title-editable {
  display: flex;
  align-items: center;
  flex: 1;
}

.formset-title-editable input {
  flex: 1;
  border: none;
  border-bottom: 2px solid transparent;
  padding: 4px 8px;
  font-size: 1.1rem;
  font-weight: 600;
  background: transparent;
  transition: border-color 0.3s;
  color: var(--text-dark);
}

.formset-title-editable input:hover {
  border-bottom-color: rgba(245, 158, 11, 0.3);
}

.formset-title-editable input:focus {
  outline: none;
  border-bottom-color: var(--accent-color);
  background-color: rgba(245, 158, 11, 0.05);
}

.formset-title-editable input::placeholder {
  color: #9ca3af;
  font-weight: 500;
  font-size: 0.95rem;
}

.drag-handle {
  cursor: grab;
  padding: 8px;
  margin-right: 8px;
  color: #9ca3af;
  display: flex;
  align-items: center;
  transition: color 0.2s;
}

.drag-handle:hover {
  color: var(--accent-color);
}

.drag-handle:active {
  cursor: grabbing;
}

.formset-item.dragging {
  opacity: 0.5;
  border: 2px dashed var(--accent-color);
  background-color: rgba(245, 158, 11, 0.05);
}

.formset-item.drag-over {
  border-top: 3px solid var(--accent-color);
  margin-top: 10px;
}

.delete-checkbox {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--danger-color);
  font-size: 0.9rem;
}

.add-formset-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-weight: 500;
  font-size: 0.875rem;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 2px 6px rgba(30, 64, 175, 0.15);
  position: relative;
  overflow: hidden;
  margin: 1.5rem 0 1.5rem 1rem !important;
}

.add-formset-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.3);
  transform: translate(-50%, -50%);
  transition: width 0.6s, height 0.6s;
}

.add-formset-btn:hover {
  background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
  box-shadow: 0 4px 12px rgba(30, 64, 175, 0.25);
  transform: translateY(-1px);
}

.add-formset-btn:hover::before {
  width: 300px;
  height: 300px;
}

.add-formset-btn i {
  position: relative;
  z-index: 1;
  font-size: 1rem;
}

.add-formset-btn span {
  position: relative;
  z-index: 1;
}

.add-formset-btn:active {
  transform: translateY(0);
}

/* Submit Section */
.submit-section {
  padding: 2rem;
  background: var(--bg-light);
  border-top: 1px solid var(--border-color);
  display: flex;
  gap: 1rem;
  justify-content: flex-end;
}

.btn-submit-edit {
  padding: 0.875rem 2rem;
  background: var(--primary);
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 0.625rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.btn-submit-edit:hover {
  background: var(--primary-dark);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  transform: translateY(-1px);
}

.btn-submit-edit i {
  font-size: 1.125rem;
}

.btn-cancel-edit {
  padding: 1.125rem 2.75rem;
  background: white;
  color: var(--gray-700);
  border: 2px solid var(--gray-300);
  border-radius: var(--radius-md);
  font-size: 1.125rem;
  font-weight: 700;
  letter-spacing: -0.01em;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  text-decoration: none;
  display: flex;
  align-items: center;
  gap: 0.75rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.btn-cancel-edit:hover {
  background: var(--gray-50);
  border-color: var(--gray-400);
  transform: translateY(-2px);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  color: var(--gray-900);
}

.btn-cancel-edit:active {
  transform: translateY(0);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.btn-cancel-edit i {
  font-size: 1.125rem;
}

/* Guidelines */
.guidelines-card {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  border: 1px solid var(--border-color);
  margin-bottom: 1.5rem;
}

.guidelines-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--text-dark);
  margin: 0 0 1rem 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.guidelines-title i {
  color: var(--primary-color);
}

.guidelines-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.guidelines-list li {
  padding: 0.75rem 0;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  align-items: flex-start;
  gap: 0.75rem;
  font-size: 0.9rem;
  color: var(--text-medium);
}

.guidelines-list li:last-child {
  border-bottom: none;
}

.guidelines-list li i {
  color: var(--success-color);
  margin-top: 0.2rem;
  flex-shrink: 0;
}

/* Responsive */
@media (max-width: 992px) {
  .form-layout-edit {
    grid-template-columns: 1fr;
  }
  
  .form-sidebar-edit {
    border-right: none;
    border-bottom: 1px solid var(--border-color);
  }
}

@media (max-width: 768px) {
  .form-row-edit {
    grid-template-columns: 1fr;
  }
  
  .cover-options-grid {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .submit-section {
    flex-direction: column-reverse;
  }
  
  .btn-submit-edit,
  .btn-cancel-edit {
    width: 100%;
  }
  
  /* Mobile section title adjustments */
  .section-title-edit {
    font-size: 1.125rem;
    padding: 1.25rem 1.5rem;
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
  }
  
  .section-title-edit:hover {
    background: linear-gradient(135deg, #1e3a8a 0%, #2563eb 100%);
  }
  
  .section-title-edit i {
    font-size: 1.25rem;
    color: #fbbf24;
  }
  
  /* Add Education/Experience Buttons - Mobile */
  .add-formset-btn {
    width: 100%;
    justify-content: center;
    padding: 0.625rem 1rem;
    font-size: 0.875rem;
  }
  
  .add-formset-btn i {
    font-size: 1rem;
  }
  
  /* CV Section Mobile Responsive */
  .current-cv-display {
    padding: 1rem;
  }
  
  .cv-file-info {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  
  .cv-file-info > i {
    font-size: 1.5rem !important;
  }
  
  .cv-file-name {
    font-size: 0.9rem;
  }
  
  .cv-file-date {
    font-size: 0.75rem;
  }
  
  .btn-cv-preview {
    width: 100%;
    justify-content: center;
    padding: 0.75rem 1rem;
  }
  
  .cv-replace-note {
    font-size: 0.75rem;
    padding: 0.5rem;
  }
  
  .cv-upload-wrapper input[type="file"] {
    padding: 0.5rem;
    font-size: 0.875rem;
  }
  
  /* Address dropdowns mobile - prevents iOS zoom */
  #id_province,
  #id_city,
  #id_barangay {
    font-size: 16px !important;
  }
}
</style>
{% endblock %}

{% block content %}
<!-- Header -->
<div class="edit-header">
  <div class="container">
    <h1>
      <i class="bi bi-pencil-square"></i>
      Edit Profile & CV Details
    </h1>
    <p>Update your personal information and professional details</p>
  </div>
</div>

<!-- Main Form -->
<div class="container">
  <form method="post" enctype="multipart/form-data" id="profileForm">
    {% csrf_token %}
    {{ education_formset.management_form }}
    {{ experience_formset.management_form }}
    
    <div class="form-container-edit">
      <div class="form-layout-edit">
        <!-- Sidebar -->
        <div class="form-sidebar-edit">
          <div class="guidelines-card">
            <h3 class="guidelines-title">
              <i class="bi bi-lightbulb"></i>
              Profile Tips
            </h3>
            <ul class="guidelines-list">
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Use a clear, professional profile picture</span>
              </li>
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Choose a cover photo that represents you</span>
              </li>
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Write a compelling bio summary</span>
              </li>
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Add all relevant work experience</span>
              </li>
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Include your education background</span>
              </li>
              <li>
                <i class="bi bi-check-circle-fill"></i>
                <span>Keep contact information up to date</span>
              </li>
            </ul>
          </div>
        </div>
        
        <!-- Main Form -->
        <div class="form-main-edit">
          <!-- Profile Picture Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-person-circle"></i>
              Profile Picture
              
            </h2>
            
            <div class="profile-pic-upload">
              {% if user.profile_picture %}
                <img src="{{ user.profile_picture.url }}" class="current-profile-pic" alt="Current Profile">
              {% else %}
                <img src="{% static 'images/default_profile.png' %}" class="current-profile-pic" alt="Default Profile">
              {% endif %}
              
              <div class="pic-upload-content">
                <div class="pic-upload-title">Change Profile Picture</div>
                <div class="pic-upload-hint">JPG, PNG or GIF. Max size 5MB</div>
                {{ form.profile_picture }}
                {% if form.profile_picture.errors %}
                  <div class="text-danger">{{ form.profile_picture.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>
          
          <!-- Cover Photo Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-image"></i>
              Cover Photo
              
            </h2>
            
            <div class="cover-photo-selector">
              <div class="form-label-edit">Choose a Gradient</div>
              <div class="cover-options-grid">
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default1" {% if user.cover_photo == 'default1' or not user.cover_photo %}checked{% endif %}>
                  <div class="cover-preview gradient-1"></div>
                  <div class="cover-label">Purple</div>
                </label>
                
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default2" {% if user.cover_photo == 'default2' %}checked{% endif %}>
                  <div class="cover-preview gradient-2"></div>
                  <div class="cover-label">Pink</div>
                </label>
                
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default3" {% if user.cover_photo == 'default3' %}checked{% endif %}>
                  <div class="cover-preview gradient-3"></div>
                  <div class="cover-label">Blue</div>
                </label>
                
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default4" {% if user.cover_photo == 'default4' %}checked{% endif %}>
                  <div class="cover-preview gradient-4"></div>
                  <div class="cover-label">Green</div>
                </label>
                
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default5" {% if user.cover_photo == 'default5' %}checked{% endif %}>
                  <div class="cover-preview gradient-5"></div>
                  <div class="cover-label">Sunset</div>
                </label>
                
                <label class="cover-option">
                  <input type="radio" name="cover_photo" value="default6" {% if user.cover_photo == 'default6' %}checked{% endif %}>
                  <div class="cover-preview gradient-6"></div>
                  <div class="cover-label">Ocean</div>
                </label>
              </div>
              
              <div class="form-label-edit" style="margin-top: 1.5rem;">Or Upload Custom Cover</div>
              <div class="custom-cover-upload">
                <i class="bi bi-cloud-arrow-up upload-icon-large"></i>
                <div style="margin-bottom: 0.75rem; font-weight: 600; color: var(--text-dark);">Upload Your Own Cover Photo</div>
                <div style="font-size: 0.85rem; color: var(--text-light); margin-bottom: 1rem;">Recommended size: 1500x500px</div>
                {{ form.cover_photo_custom }}
                {% if form.cover_photo_custom.errors %}
                  <div class="text-danger">{{ form.cover_photo_custom.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>
          
          <!-- Personal Details Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-person"></i>
              Personal Details
              
            </h2>
            
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.first_name.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-person"></i>
                  First Name
                </label>
                {{ form.first_name }}
                {% if form.first_name.errors %}
                  <div class="text-danger">{{ form.first_name.errors }}</div>
                {% endif %}
              </div>
              
              <div class="form-group-edit">
                <label for="{{ form.last_name.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-person"></i>
                  Last Name
                </label>
                {{ form.last_name }}
                {% if form.last_name.errors %}
                  <div class="text-danger">{{ form.last_name.errors }}</div>
                {% endif %}
              </div>
            </div>
            
            <div class="form-group-edit">
              <label for="{{ form.username.id_for_label }}" class="form-label-edit">
                <i class="bi bi-at"></i>
                Username
              </label>
              {{ form.username }}
              <div class="form-text-edit">
                <i class="bi bi-info-circle"></i>
                Your unique username (cannot be changed frequently)
              </div>
              {% if form.username.errors %}
                <div class="text-danger">{{ form.username.errors }}</div>
              {% endif %}
            </div>
            
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.email.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-envelope"></i>
                  Email
                </label>
                {{ form.email }}
                {% if form.email.errors %}
                  <div class="text-danger">{{ form.email.errors }}</div>
                {% endif %}
              </div>
              
              <div class="form-group-edit">
                <label for="{{ form.contact_number.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-telephone"></i>
                  Contact Number
                </label>
                {{ form.contact_number }}
                {% if form.contact_number.errors %}
                  <div class="text-danger">{{ form.contact_number.errors }}</div>
                {% endif %}
              </div>
            </div>
            
            <!-- Address Fields (Cascading Dropdowns) -->
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.province.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-geo-alt"></i>
                  Province <span style="color: #dc3545;">*</span>
                </label>
                {{ form.province }}
                {% if form.province.errors %}
                  <div class="text-danger">{{ form.province.errors }}</div>
                {% endif %}
              </div>
              
              <div class="form-group-edit">
                <label for="{{ form.city.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-building"></i>
                  City/Municipality <span style="color: #dc3545;">*</span>
                </label>
                {{ form.city }}
                {% if form.city.errors %}
                  <div class="text-danger">{{ form.city.errors }}</div>
                {% endif %}
              </div>
            </div>
            
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.barangay.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-pin-map"></i>
                  Barangay <span style="color: #dc3545;">*</span>
                </label>
                {{ form.barangay }}
                {% if form.barangay.errors %}
                  <div class="text-danger">{{ form.barangay.errors }}</div>
                {% endif %}
              </div>
              
              <div class="form-group-edit">
                <label for="{{ form.zip_code.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-mailbox"></i>
                  ZIP Code <small style="color: #6c757d;">(Auto-fills)</small>
                </label>
                {{ form.zip_code }}
                <small class="form-text" style="color: #6c757d; font-size: 0.875rem; display: block; margin-top: 0.25rem;">
                  Automatically filled when you select a city
                </small>
                {% if form.zip_code.errors %}
                  <div class="text-danger">{{ form.zip_code.errors }}</div>
                {% endif %}
              </div>
            </div>
            
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.subdivision.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-houses"></i>
                  Subdivision <small style="color: #6c757d;">(Optional)</small>
                </label>
                {{ form.subdivision }}
                {% if form.subdivision.errors %}
                  <div class="text-danger">{{ form.subdivision.errors }}</div>
                {% endif %}
              </div>
              
              <div class="form-group-edit">
                <label for="{{ form.street.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-signpost"></i>
                  Street <small style="color: #6c757d;">(Optional)</small>
                </label>
                {{ form.street }}
                {% if form.street.errors %}
                  <div class="text-danger">{{ form.street.errors }}</div>
                {% endif %}
              </div>
            </div>
            
            <div class="form-row-edit">
              <div class="form-group-edit">
                <label for="{{ form.gender.id_for_label }}" class="form-label-edit">
                  <i class="bi bi-gender-ambiguous"></i>
                  Gender
                </label>
                {{ form.gender }}
                {% if form.gender.errors %}
                  <div class="text-danger">{{ form.gender.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>
          
          <!-- Personal Summary Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-chat-quote"></i>
              Personal Summary
              
            </h2>
            
            <div class="form-group-edit">
              <label for="{{ form.job_title.id_for_label }}" class="form-label-edit">
                <i class="bi bi-briefcase"></i>
                Job Title / Profession
              </label>
              {{ form.job_title }}
              <div class="form-text-edit">
                <i class="bi bi-info-circle"></i>
                Your current job title or profession (e.g., Software Developer, Electrician, Plumber)
              </div>
              {% if form.job_title.errors %}
                <div class="text-danger">{{ form.job_title.errors }}</div>
              {% endif %}
            </div>
            
            <div class="form-group-edit">
              <label for="{{ form.bio.id_for_label }}" class="form-label-edit">
                <i class="bi bi-file-text"></i>
                Bio
              </label>
              {{ form.bio }}
              <div class="form-text-edit">
                <i class="bi bi-info-circle"></i>
                Provide a brief summary about yourself and your professional background
              </div>
              {% if form.bio.errors %}
                <div class="text-danger">{{ form.bio.errors }}</div>
              {% endif %}
            </div>
          </div>
          
          <!-- CV/Resume Upload Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-file-earmark-text"></i>
              CV/Resume
              
            </h2>
            
            <div class="form-group-edit">
              <label for="{{ form.cv_file.id_for_label }}" class="form-label-edit">
                <i class="bi bi-upload"></i>
                Upload CV/Resume
              </label>
              
              <!-- Current CV Display -->
              {% if form.instance.cv_file %}
              <div class="current-cv-display">
                <div class="cv-file-info">
                  <i class="bi {{ form.instance.cv_file|file_icon }}" style="font-size: 2rem; color: {{ form.instance.cv_file|file_color }};"></i>
                  <div class="cv-file-details">
                    <p class="cv-file-name">{{ form.instance.cv_file|original_filename }}</p>
                    {% if form.instance.cv_uploaded_at %}
                    <p class="cv-file-date">
                      <i class="bi bi-clock"></i>
                      Uploaded: {{ form.instance.cv_uploaded_at|date:"M d, Y" }}
                    </p>
                    {% endif %}
                  </div>
                  <a href="{{ form.instance.cv_file.url }}" class="btn-cv-preview" download>
                    <i class="bi bi-download"></i>
                    Download
                  </a>
                </div>
                <p class="cv-replace-note">
                  <i class="bi bi-info-circle"></i>
                  Upload a new file below to replace your current CV
                </p>
              </div>
              {% endif %}
              
              <!-- File Upload Input -->
              <div class="cv-upload-wrapper">
                {{ form.cv_file }}
                <div class="form-text-edit">
                  <i class="bi bi-info-circle"></i>
                  {{ form.cv_file.help_text }}
                </div>
              </div>
              
              {% if form.cv_file.errors %}
                <div class="text-danger">{{ form.cv_file.errors }}</div>
              {% endif %}
            </div>
          </div>
          
          <!-- Education Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-mortarboard"></i>
              Education
              
            </h2>
            
            <div id="education-formset">
              {% for edu_form in education_formset %}
                <div class="formset-item education-form" draggable="true">
                  {{ edu_form.id }}
                  {{ edu_form.order }}
                  <div class="formset-header">
                    <div class="drag-handle" title="Drag to reorder">
                      <i class="bi bi-grip-vertical"></i>
                    </div>
                    <div class="formset-title-editable">
                      <i class="bi bi-mortarboard-fill" style="color: var(--accent-color); margin-right: 8px;"></i>
                      <input 
                        type="text" 
                        name="{{ edu_form.title.html_name }}" 
                        value="{{ edu_form.title.value|default:'' }}"
                        placeholder="Enter a custom title (e.g., Bachelor's Degree)"
                        class="form-control-inline"
                        style="flex: 1; border: none; border-bottom: 2px solid transparent; padding: 4px 8px; font-size: 1.1rem; font-weight: 600; background: transparent; transition: border-color 0.3s;"
                        onfocus="this.style.borderBottomColor='var(--accent-color)'"
                        onblur="this.style.borderBottomColor='transparent'"
                      />
                    </div>
                    {% if edu_form.instance.pk %}
                      <label class="delete-checkbox">
                        {{ edu_form.DELETE }}
                        <span>Delete</span>
                      </label>
                    {% endif %}
                  </div>
                  
                  <div class="form-row-edit">
                    <div class="form-group-edit">
                      {{ edu_form.degree.label_tag }}
                      {{ edu_form.degree }}
                      {{ edu_form.degree.errors }}
                    </div>
                    <div class="form-group-edit">
                      {{ edu_form.institution.label_tag }}
                      {{ edu_form.institution }}
                      {{ edu_form.institution.errors }}
                    </div>
                  </div>
                  
                  <div class="form-row-edit">
                    <div class="form-group-edit">
                      <label for="{{ edu_form.start_year.id_for_label }}" class="form-label-edit">
                        <i class="bi bi-calendar-event"></i>
                        Start Year <span style="color: #dc3545;">*</span>
                      </label>
                      {{ edu_form.start_year }}
                      {{ edu_form.start_year.errors }}
                    </div>
                    <div class="form-group-edit">
                      <label for="{{ edu_form.end_year.id_for_label }}" class="form-label-edit">
                        <i class="bi bi-calendar-check"></i>
                        End Year <span style="color: #dc3545;">*</span>
                      </label>
                      {{ edu_form.end_year }}
                      <small class="form-text" style="color: #6c757d; font-size: 0.875rem; display: block; margin-top: 0.25rem;">
                        Select "Present" if currently studying
                      </small>
                      {{ edu_form.end_year.errors }}
                    </div>
                  </div>
                  
                  <div class="form-group-edit">
                    {{ edu_form.description.label_tag }}
                    {{ edu_form.description }}
                    {{ edu_form.description.errors }}
                  </div>
                </div>
              {% endfor %}
            </div>
            
            <button type="button" class="add-formset-btn" id="add-education">
              <i class="bi bi-plus-circle"></i>
              <span>Add Education</span>
            </button>
          </div>
          
          <!-- Work Experience Section -->
          <div class="section-edit">
            <h2 class="section-title-edit">
              <i class="bi bi-briefcase"></i>
              Work Experience
              
            </h2>
            
            <div id="experience-formset">
              {% for exp_form in experience_formset %}
                <div class="formset-item experience-form" draggable="true">
                  {{ exp_form.id }}
                  {{ exp_form.order }}
                  <div class="formset-header">
                    <div class="drag-handle" title="Drag to reorder">
                      <i class="bi bi-grip-vertical"></i>
                    </div>
                    <div class="formset-title-editable">
                      <i class="bi bi-briefcase-fill" style="color: var(--accent-color); margin-right: 8px;"></i>
                      <input 
                        type="text" 
                        name="{{ exp_form.title.html_name }}" 
                        value="{{ exp_form.title.value|default:'' }}"
                        placeholder="Enter a custom title (e.g., Senior Developer Role)"
                        class="form-control-inline"
                        style="flex: 1; border: none; border-bottom: 2px solid transparent; padding: 4px 8px; font-size: 1.1rem; font-weight: 600; background: transparent; transition: border-color 0.3s;"
                        onfocus="this.style.borderBottomColor='var(--accent-color)'"
                        onblur="this.style.borderBottomColor='transparent'"
                      />
                    </div>
                    {% if exp_form.instance.pk %}
                      <label class="delete-checkbox">
                        {{ exp_form.DELETE }}
                        <span>Delete</span>
                      </label>
                    {% endif %}
                  </div>
                  
                  <div class="form-row-edit">
                    <div class="form-group-edit">
                      {{ exp_form.job_title.label_tag }}
                      {{ exp_form.job_title }}
                      {{ exp_form.job_title.errors }}
                    </div>
                    <div class="form-group-edit">
                      {{ exp_form.company.label_tag }}
                      {{ exp_form.company }}
                      {{ exp_form.company.errors }}
                    </div>
                  </div>
                  
                  <div class="form-row-edit">
                    <div class="form-group-edit">
                      <label for="{{ exp_form.start_year.id_for_label }}" class="form-label-edit">
                        <i class="bi bi-calendar-event"></i>
                        Start Year <span style="color: #dc3545;">*</span>
                      </label>
                      {{ exp_form.start_year }}
                      {{ exp_form.start_year.errors }}
                    </div>
                    <div class="form-group-edit">
                      <label for="{{ exp_form.end_year.id_for_label }}" class="form-label-edit">
                        <i class="bi bi-calendar-check"></i>
                        End Year <span style="color: #dc3545;">*</span>
                      </label>
                      {{ exp_form.end_year }}
                      <small class="form-text" style="color: #6c757d; font-size: 0.875rem; display: block; margin-top: 0.25rem;">
                        Select "Present" if currently working here
                      </small>
                      {{ exp_form.end_year.errors }}
                    </div>
                  </div>
                  
                  <div class="form-group-edit">
                    {{ exp_form.description.label_tag }}
                    {{ exp_form.description }}
                    {{ exp_form.description.errors }}
                  </div>
                </div>
              {% endfor %}
            </div>
            
            <button type="button" class="add-formset-btn" id="add-experience">
              <i class="bi bi-plus-circle"></i>
              <span>Add Work Experience</span>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Submit Section -->
      <div class="submit-section">
        {% if request.GET.onboarding == 'true' %}
        <a href="{% url 'skip_profile_setup' %}" class="btn-cancel-edit">
          <i class="bi bi-skip-forward"></i>
          <span>Skip for now</span>
        </a>
        {% else %}
        <a href="{% url 'users:profile' user.pk %}" class="btn-cancel-edit">
          <i class="bi bi-x-circle"></i>
          <span>{% trans "Cancel" %}</span>
        </a>
        {% endif %}
        <button type="submit" class="btn-submit-edit">
          <i class="bi bi-check-circle"></i>
          <span>{% if request.GET.onboarding == 'true' %}Complete Setup{% else %}Update Profile{% endif %}</span>
        </button>
      </div>
    </div>
  </form>
  
  {% if form.errors or education_formset.errors or experience_formset.errors %}
    <div class="alert alert-danger" style="margin-top: 1rem; padding: 1rem; background: rgba(239, 68, 68, 0.1); border: 2px solid var(--danger-color); border-radius: 12px; color: var(--danger-color);">
      <strong><i class="bi bi-exclamation-triangle"></i> Please correct the errors below:</strong>
      {{ form.errors }}
      {{ education_formset.errors }}
      {{ experience_formset.errors }}
    </div>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // ========================================================================
  // PSGC API Cascading Dropdowns for Philippine Address
  // ========================================================================
  const provinceInput = document.getElementById('id_province');
  const cityInput = document.getElementById('id_city');
  const barangayInput = document.getElementById('id_barangay');
  const zipCodeInput = document.getElementById('id_zip_code');
  
  // Cache for API responses
  const addressCache = {
    provinces: null,
    cities: {},
    barangays: {}
  };
  
  // Philippine ZIP Code Mapping (Major Cities and Municipalities)
  const zipCodeMap = {
    // Metro Manila
    'Manila': '1000', 'Quezon City': '1100', 'Caloocan': '1400', 'Las PiÃ±as': '1740',
    'Makati': '1200', 'Malabon': '1470', 'Mandaluyong': '1550', 'Marikina': '1800',
    'Muntinlupa': '1770', 'Navotas': '1485', 'ParaÃ±aque': '1700', 'Pasay': '1300',
    'Pasig': '1600', 'Pateros': '1620', 'San Juan': '1500', 'Taguig': '1630',
    'Valenzuela': '1440',
    
    // Cavite
    'Bacoor': '4102', 'Cavite City': '4100', 'DasmariÃ±as': '4114', 'Imus': '4103',
    'Tagaytay': '4120', 'Trece Martires': '4109', 'General Trias': '4107',
    'Silang': '4118', 'Carmona': '4116', 'Kawit': '4104', 'Naic': '4110',
    'Rosario': '4106', 'Tanza': '4108', 'Noveleta': '4105', 'Maragondon': '4112',
    'Ternate': '4111', 'Alfonso': '4123', 'Amadeo': '4119', 'Gen. Mariano Alvarez': '4117',
    'Indang': '4122', 'Magallanes': '4113', 'Mendez': '4124', 'Tagaytay City': '4120',
    
    // Laguna
    'San Pedro': '4023', 'BiÃ±an': '4024', 'Santa Rosa': '4026', 'Cabuyao': '4025',
    'Calamba': '4027', 'Los BaÃ±os': '4030', 'Bay': '4033', 'Calauan': '4012',
    'San Pablo': '4000', 'Alaminos': '4001', 'Pila': '4010', 'Victoria': '4002',
    'Nagcarlan': '4002', 'Liliw': '4004', 'Majayjay': '4005', 'Magdalena': '4007',
    'Paete': '4016', 'Kalayaan': '4015', 'Lumban': '4014', 'Cavinti': '4013',
    'Luisiana': '4032', 'Mabitac': '4020', 'Famy': '4021', 'Siniloan': '4029',
    'Pangil': '4018', 'Pakil': '4017', 'Pagsanjan': '4008', 'Santa Cruz': '4009',
    
    // Rizal
    'Antipolo': '1870', 'Cainta': '1900', 'Taytay': '1920', 'Angono': '1930',
    'Binangonan': '1940', 'Cardona': '1950', 'Morong': '1960', 'Baras': '1970',
    'Tanay': '1980', 'Pililla': '1910', 'Rodriguez': '1860', 'San Mateo': '1850',
    'Teresa': '1880', 'Jalajala': '1990',
    
    // Bulacan
    'Malolos': '3000', 'Meycauayan': '3020', 'Marilao': '3019', 'Bocaue': '3018',
    'Balagtas': '3016', 'Guiguinto': '3015', 'Pandi': '3014', 'Santa Maria': '3022',
    'Obando': '3021', 'Hagonoy': '3002', 'Calumpit': '3003', 'Plaridel': '3004',
    'Pulilan': '3005', 'Baliuag': '3006', 'Bustos': '3007', 'San Rafael': '3008',
    'Angat': '3012', 'Norzagaray': '3013', 'San Ildefonso': '3010', 'San Miguel': '3011',
    'DoÃ±a Remedios Trinidad': '3009',
    
    // Pampanga
    'San Fernando': '2000', 'Angeles': '2009', 'Mabalacat': '2010', 'Porac': '2008',
    'Guagua': '2003', 'Lubao': '2005', 'Floridablanca': '2006', 'Santa Rita': '2001',
    'Bacolor': '2001', 'Mexico': '2021', 'Apalit': '2016', 'Macabebe': '2018',
    'Masantol': '2017', 'Minalin': '2019', 'San Luis': '2014', 'San Simon': '2015',
    'Santo Tomas': '2020', 'Sasmuan': '2002', 'Candaba': '2013', 'Arayat': '2012',
    'Magalang': '2011',
    
    // Batangas
    'Batangas City': '4200', 'Lipa': '4217', 'Tanauan': '4232', 'Santo Tomas': '4234',
    'Lemery': '4209', 'Taal': '4208', 'Balayan': '4213', 'Nasugbu': '4231',
    'Calaca': '4212', 'Calatagan': '4215', 'Lian': '4216', 'Tuy': '4214',
    'Mabini': '4202', 'Tingloy': '4226', 'San Pascual': '4204', 'Bauan': '4201',
    'San Luis': '4210', 'Taysan': '4227', 'Lobo': '4229', 'San Juan': '4226',
    'Rosario': '4106', 'Ibaan': '4230', 'Padre Garcia': '4224', 'Cuenca': '4222',
    
    // Cebu
    'Cebu City': '6000', 'Mandaue': '6014', 'Lapu-Lapu': '6015', 'Talisay': '6045',
    'Naga': '6037', 'Carcar': '6019', 'Toledo': '6038', 'Danao': '6004',
    'Bogo': '6010', 'Consolacion': '6001', 'Liloan': '6002', 'Compostela': '6003',
    'Minglanilla': '6046', 'San Fernando': '6047',
    
    // Davao
    'Davao City': '8000', 'Tagum': '8100', 'Panabo': '8105', 'Digos': '8002',
    'Mati': '8200', 'Samal': '8119',
    
    // Iloilo
    'Iloilo City': '5000', 'Passi': '5037', 'Pototan': '5008', 'Janiuay': '5034',
    'Mina': '5032', 'Barotac Nuevo': '5007', 'Dumangas': '5014',
    
    // Pangasinan
    'Dagupan': '2400', 'Alaminos': '2404', 'Urdaneta': '2428', 'San Carlos': '2420',
    'Lingayen': '2401', 'Malasiqui': '2421', 'Binalonan': '2436',
    
    // Baguio and Benguet
    'Baguio': '2600', 'La Trinidad': '2601', 'Itogon': '2602', 'Tuba': '2603',
    
    // Others
    'Laoag': '2900', 'Vigan': '2700', 'Tuguegarao': '3500', 'Santiago': '3311',
    'Cabanatuan': '3100', 'Palayan': '3132', 'Olongapo': '2200', 'Subic': '2222',
    'Puerto Princesa': '5300', 'Legazpi': '4500', 'Naga': '4400', 'Iriga': '4431',
    'Bacolod': '6100', 'Tacloban': '6500', 'Ormoc': '6541', 'Calbayog': '6710',
    'Zamboanga': '7000', 'Pagadian': '7016', 'Butuan': '8600', 'Cagayan de Oro': '9000',
    'Iligan': '9200', 'General Santos': '9500', 'Koronadal': '9506', 'Cotabato City': '9600'
  };
  
  // Convert text inputs to select dropdowns
  function convertToSelect(input, placeholder) {
    const select = document.createElement('select');
    select.id = input.id;
    select.name = input.name;
    select.className = input.className;
    select.required = input.required;
    
    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.textContent = placeholder;
    select.appendChild(defaultOption);
    
    input.parentNode.replaceChild(select, input);
    return select;
  }
  
  // Initialize dropdowns
  if (provinceInput && cityInput && barangayInput) {
    const provinceSelect = convertToSelect(provinceInput, 'Select Province');
    const citySelect = convertToSelect(cityInput, 'Select City/Municipality');
    const barangaySelect = convertToSelect(barangayInput, 'Select Barangay');
    
    // Store original values if editing
    const originalProvince = provinceInput.value;
    const originalCity = cityInput.value;
    const originalBarangay = barangayInput.value;
    
    // Fetch provinces
    function loadProvinces() {
      if (addressCache.provinces) {
        populateProvinces(addressCache.provinces);
        return;
      }
      
      fetch('https://psgc.gitlab.io/api/provinces/')
        .then(response => response.json())
        .then(data => {
          addressCache.provinces = data;
          populateProvinces(data);
        })
        .catch(error => {
          console.error('Error loading provinces:', error);
          alert('Failed to load provinces. Please refresh the page.');
        });
    }
    
    function populateProvinces(provinces) {
      provinceSelect.innerHTML = '<option value="">Select Province</option>';
      
      provinces.sort((a, b) => a.name.localeCompare(b.name));
      
      provinces.forEach(province => {
        const option = document.createElement('option');
        option.value = province.name;
        option.dataset.code = province.code;
        option.textContent = province.name;
        provinceSelect.appendChild(option);
      });
      
      // Restore original value if editing
      if (originalProvince) {
        provinceSelect.value = originalProvince;
        if (provinceSelect.value === originalProvince) {
          const selectedOption = provinceSelect.options[provinceSelect.selectedIndex];
          loadCities(selectedOption.dataset.code, originalCity);
        }
      }
    }
    
    // Fetch cities when province is selected
    function loadCities(provinceCode, preselectedCity = null) {
      citySelect.innerHTML = '<option value="">Loading cities...</option>';
      citySelect.disabled = true;
      barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
      barangaySelect.disabled = true;
      
      if (addressCache.cities[provinceCode]) {
        populateCities(addressCache.cities[provinceCode], preselectedCity);
        return;
      }
      
      fetch(`https://psgc.gitlab.io/api/provinces/${provinceCode}/cities-municipalities/`)
        .then(response => response.json())
        .then(data => {
          addressCache.cities[provinceCode] = data;
          populateCities(data, preselectedCity);
        })
        .catch(error => {
          console.error('Error loading cities:', error);
          citySelect.innerHTML = '<option value="">Failed to load cities</option>';
        });
    }
    
    function populateCities(cities, preselectedCity = null) {
      citySelect.innerHTML = '<option value="">Select City/Municipality</option>';
      
      cities.sort((a, b) => a.name.localeCompare(b.name));
      
      cities.forEach(city => {
        const option = document.createElement('option');
        option.value = city.name;
        option.dataset.code = city.code;
        option.textContent = city.name;
        citySelect.appendChild(option);
      });
      
      citySelect.disabled = false;
      
      // Restore original value if editing
      if (preselectedCity) {
        citySelect.value = preselectedCity;
        if (citySelect.value === preselectedCity) {
          const selectedOption = citySelect.options[citySelect.selectedIndex];
          loadBarangays(selectedOption.dataset.code, originalBarangay);
        }
      }
    }
    
    // Fetch barangays when city is selected
    function loadBarangays(cityCode, preselectedBarangay = null) {
      barangaySelect.innerHTML = '<option value="">Loading barangays...</option>';
      barangaySelect.disabled = true;
      
      if (addressCache.barangays[cityCode]) {
        populateBarangays(addressCache.barangays[cityCode], preselectedBarangay);
        return;
      }
      
      fetch(`https://psgc.gitlab.io/api/cities-municipalities/${cityCode}/barangays/`)
        .then(response => response.json())
        .then(data => {
          addressCache.barangays[cityCode] = data;
          populateBarangays(data, preselectedBarangay);
        })
        .catch(error => {
          console.error('Error loading barangays:', error);
          barangaySelect.innerHTML = '<option value="">Failed to load barangays</option>';
        });
    }
    
    function populateBarangays(barangays, preselectedBarangay = null) {
      barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
      
      barangays.sort((a, b) => a.name.localeCompare(b.name));
      
      barangays.forEach(barangay => {
        const option = document.createElement('option');
        option.value = barangay.name;
        option.textContent = barangay.name;
        barangaySelect.appendChild(option);
      });
      
      barangaySelect.disabled = false;
      
      // Restore original value if editing
      if (preselectedBarangay) {
        // Remove "Brgy. " prefix if present for matching
        const cleanBarangay = preselectedBarangay.replace(/^Brgy\.\s*/i, '');
        barangaySelect.value = cleanBarangay;
      }
    }
    
    // Event listeners for cascading
    provinceSelect.addEventListener('change', function() {
      const selectedOption = this.options[this.selectedIndex];
      if (selectedOption.dataset.code) {
        loadCities(selectedOption.dataset.code);
      } else {
        citySelect.innerHTML = '<option value="">Select City/Municipality</option>';
        citySelect.disabled = true;
        barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
        barangaySelect.disabled = true;
      }
    });
    
    citySelect.addEventListener('change', function() {
      const selectedOption = this.options[this.selectedIndex];
      if (selectedOption.dataset.code) {
        loadBarangays(selectedOption.dataset.code);
        
        // Auto-fill ZIP code if available
        const cityName = selectedOption.value;
        if (zipCodeInput && zipCodeMap[cityName]) {
          zipCodeInput.value = zipCodeMap[cityName];
          zipCodeInput.style.backgroundColor = '#e8f5e9'; // Light green to indicate auto-filled
          setTimeout(() => {
            zipCodeInput.style.backgroundColor = '';
          }, 1500);
        } else if (zipCodeInput) {
          // Clear ZIP if no match found
          if (!zipCodeInput.value || zipCodeInput.dataset.autoFilled === 'true') {
            zipCodeInput.value = '';
          }
        }
      } else {
        barangaySelect.innerHTML = '<option value="">Select Barangay</option>';
        barangaySelect.disabled = true;
        if (zipCodeInput) {
          zipCodeInput.value = '';
        }
      }
    });
    
    // Initialize: Load provinces
    loadProvinces();
  }
  
  // ========================================================================
  // DRAG AND DROP REORDERING FOR EDUCATION CARDS
  // ========================================================================
  
  const educationContainer = document.getElementById('education-formset');
  
  if (educationContainer) {
    let draggedElement = null;
    
    // Get all education form items
    const educationForms = educationContainer.querySelectorAll('.education-form');
    
    educationForms.forEach((formItem, index) => {
      // Set initial order values
      const orderInput = formItem.querySelector('.education-order-field');
      if (orderInput && !orderInput.value) {
        orderInput.value = index;
      }
      
      // Drag start
      formItem.addEventListener('dragstart', function(e) {
        draggedElement = this;
        this.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/html', this.innerHTML);
      });
      
      // Drag end
      formItem.addEventListener('dragend', function(e) {
        this.classList.remove('dragging');
        
        // Remove all drag-over classes
        educationContainer.querySelectorAll('.education-form').forEach(item => {
          item.classList.remove('drag-over');
        });
        
        // Update order values
        updateEducationOrder();
      });
      
      // Drag over
      formItem.addEventListener('dragover', function(e) {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        
        if (this !== draggedElement) {
          this.classList.add('drag-over');
        }
        
        return false;
      });
      
      // Drag enter
      formItem.addEventListener('dragenter', function(e) {
        if (this !== draggedElement) {
          this.classList.add('drag-over');
        }
      });
      
      // Drag leave
      formItem.addEventListener('dragleave', function(e) {
        this.classList.remove('drag-over');
      });
      
      // Drop
      formItem.addEventListener('drop', function(e) {
        e.stopPropagation();
        e.preventDefault();
        
        if (draggedElement !== this) {
          // Get bounding rectangles
          const draggingRect = draggedElement.getBoundingClientRect();
          const targetRect = this.getBoundingClientRect();
          
          // Determine if we should insert before or after
          if (e.clientY < targetRect.top + targetRect.height / 2) {
            // Insert before
            educationContainer.insertBefore(draggedElement, this);
          } else {
            // Insert after
            educationContainer.insertBefore(draggedElement, this.nextSibling);
          }
        }
        
        this.classList.remove('drag-over');
        return false;
      });
    });
    
    // Update order field values based on current DOM order
    function updateEducationOrder() {
      const forms = educationContainer.querySelectorAll('.education-form');
      forms.forEach((form, index) => {
        const orderInput = form.querySelector('.education-order-field');
        if (orderInput) {
          orderInput.value = index;
          console.log(`Updated order for education form ${index}:`, orderInput.value);
        }
      });
    }
  }
  
  // ========================================================================
  // DRAG AND DROP REORDERING FOR EXPERIENCE CARDS
  // ========================================================================
  
  const experienceContainer = document.getElementById('experience-formset');
  
  if (experienceContainer) {
    let draggedElement = null;
    
    // Get all experience form items
    const experienceForms = experienceContainer.querySelectorAll('.experience-form');
    
    experienceForms.forEach((formItem, index) => {
      // Set initial order values
      const orderInput = formItem.querySelector('.experience-order-field');
      if (orderInput && !orderInput.value) {
        orderInput.value = index;
      }
      
      // Drag start
      formItem.addEventListener('dragstart', function(e) {
        draggedElement = this;
        this.classList.add('dragging');
        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/html', this.innerHTML);
      });
      
      // Drag end
      formItem.addEventListener('dragend', function(e) {
        this.classList.remove('dragging');
        
        // Remove all drag-over classes
        experienceContainer.querySelectorAll('.experience-form').forEach(item => {
          item.classList.remove('drag-over');
        });
        
        // Update order values
        updateExperienceOrder();
      });
      
      // Drag over
      formItem.addEventListener('dragover', function(e) {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        
        if (this !== draggedElement) {
          this.classList.add('drag-over');
        }
        
        return false;
      });
      
      // Drag enter
      formItem.addEventListener('dragenter', function(e) {
        if (this !== draggedElement) {
          this.classList.add('drag-over');
        }
      });
      
      // Drag leave
      formItem.addEventListener('dragleave', function(e) {
        this.classList.remove('drag-over');
      });
      
      // Drop
      formItem.addEventListener('drop', function(e) {
        e.stopPropagation();
        e.preventDefault();
        
        if (draggedElement !== this) {
          // Get bounding rectangles
          const draggingRect = draggedElement.getBoundingClientRect();
          const targetRect = this.getBoundingClientRect();
          
          // Determine if we should insert before or after
          if (e.clientY < targetRect.top + targetRect.height / 2) {
            // Insert before
            experienceContainer.insertBefore(draggedElement, this);
          } else {
            // Insert after
            experienceContainer.insertBefore(draggedElement, this.nextSibling);
          }
        }
        
        this.classList.remove('drag-over');
        return false;
      });
    });
    
    // Update order field values based on current DOM order
    function updateExperienceOrder() {
      const forms = experienceContainer.querySelectorAll('.experience-form');
      forms.forEach((form, index) => {
        const orderInput = form.querySelector('.experience-order-field');
        if (orderInput) {
          orderInput.value = index;
          console.log(`Updated order for experience form ${index}:`, orderInput.value);
        }
      });
    }
  }
  
  // Apply modern styling to form controls
  const formControls = document.querySelectorAll('input[type="text"], input[type="email"], input[type="date"], select, textarea');
  formControls.forEach(control => {
    if (!control.classList.contains('form-control-edit')) {
      control.classList.add('form-control-edit');
    }
  });
  
  // Add Education Form
  document.getElementById('add-education').addEventListener('click', function(e) {
    e.preventDefault();
    const formCount = document.getElementById('id_education-TOTAL_FORMS');
    const formNum = parseInt(formCount.value);
    const container = document.getElementById('education-formset');
    const template = document.querySelector('.education-form');
    
    if (template) {
      const newForm = template.cloneNode(true);
      newForm.innerHTML = newForm.innerHTML
        .replace(/education-\d+-/g, `education-${formNum}-`)
        .replace(/id_education-\d+-/g, `id_education-${formNum}-`)
        .replace(/value="[^"]*"/g, '')
        .replace(/checked/g, '');
      
      // Update formset title
      const title = newForm.querySelector('.formset-title');
      if (title) {
        title.textContent = `Education Entry #${formNum + 1}`;
      }
      
      // Remove delete checkbox for new forms
      const deleteLabel = newForm.querySelector('.delete-checkbox');
      if (deleteLabel) {
        deleteLabel.remove();
      }
      
      container.appendChild(newForm);
      formCount.value = formNum + 1;
      
      // Apply styling to new form controls
      newForm.querySelectorAll('input, select, textarea').forEach(control => {
        control.classList.add('form-control-edit');
      });
    }
  });
  
  // Add Experience Form
  document.getElementById('add-experience').addEventListener('click', function(e) {
    e.preventDefault();
    const formCount = document.getElementById('id_experience-TOTAL_FORMS');
    const formNum = parseInt(formCount.value);
    const container = document.getElementById('experience-formset');
    const template = document.querySelector('.experience-form');
    
    if (template) {
      const newForm = template.cloneNode(true);
      newForm.innerHTML = newForm.innerHTML
        .replace(/experience-\d+-/g, `experience-${formNum}-`)
        .replace(/id_experience-\d+-/g, `id_experience-${formNum}-`)
        .replace(/value="[^"]*"/g, '')
        .replace(/checked/g, '');
      
      // Update formset title
      const title = newForm.querySelector('.formset-title');
      if (title) {
        title.textContent = `Experience Entry #${formNum + 1}`;
      }
      
      // Remove delete checkbox for new forms
      const deleteLabel = newForm.querySelector('.delete-checkbox');
      if (deleteLabel) {
        deleteLabel.remove();
      }
      
      container.appendChild(newForm);
      formCount.value = formNum + 1;
      
      // Apply styling to new form controls
      newForm.querySelectorAll('input, select, textarea').forEach(control => {
        control.classList.add('form-control-edit');
      });
    }
  });
  
  // Handle form submission
  document.getElementById('profileForm').addEventListener('submit', function() {
    // Update total form counts
    const educationForms = document.querySelectorAll('.education-form');
    document.getElementById('id_education-TOTAL_FORMS').value = educationForms.length;
    
    const experienceForms = document.querySelectorAll('.experience-form');
    document.getElementById('id_experience-TOTAL_FORMS').value = experienceForms.length;
  });
});
</script>
{% endblock %}


{% block guide_data %}
{
    "enabled": true,
    "page_name": "profile_edit",
    "title": "Edit Profile Guide",
    "steps": [
        {
            "title": "Update Your Profile \u270f\ufe0f",
            "content": "<h3>Keep Your Information Current</h3><p>Your profile is your professional identity. Keep it updated to attract better opportunities!</p>"
        },
        {
            "title": "Basic Information \ud83d\udccb",
            "content": "<h3>Personal Details</h3><p>Update:</p><ul><li>Profile picture</li><li>Bio/About me</li><li>Job title</li><li>Contact information</li><li>Location</li></ul><p>Make a great first impression!</p>"
        },
        {
            "title": "Skills & Experience \ud83d\udee0\ufe0f",
            "content": "<h3>Showcase Your Abilities</h3><ul><li>Add new skills</li><li>Update work experience</li><li>Add certifications</li><li>Upload portfolio photos</li></ul><div class='guide-tip'><strong>\ud83d\udca1 Tip:</strong> Verified skills get more attention!</div>"
        },
        {
            "title": "Save Changes \u2705",
            "content": "<h3>Update Your Profile</h3><p>After making changes:</p><ol><li>Review all edits</li><li>Make sure everything is accurate</li><li>Click 'Save Changes'</li></ol><p>Your updated profile is now live! \ud83c\udf89</p>"
        }
    ]
}
{% endblock %}