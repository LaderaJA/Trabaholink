{% extends "mainpages/base.html" %} 
{% load static %} 
{% block title %}Home | TrabahoLink{% endblock %}
{% block css %}  <link rel="stylesheet" href="{% static 'css/home.css' %}"></link>
{% endblock %}
{% block content %}


<!-- Enhanced Hero Section -->
<section class="hero-section">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-6 mb-4 mb-lg-0">
        <h1 class="hero-title animate-on-scroll">Find Skilled Workers for Your Home</h1>
        <p class="hero-subtitle animate-on-scroll animate-delay-1">
          TrabahoLink connects you with trusted professionals for all your
          household needs - from plumbing to gardening and everything in
          between.
        </p>
        <div class="d-flex gap-3 animate-on-scroll animate-delay-2">
          <a href="{% url 'jobs:job_list' %}" class="btn btn-primary btn-lg">
            <i class="bi bi-search"></i>
            Browse Jobs
          </a>
          <a href="#how-it-works" class="btn btn-outline-secondary btn-lg">
            <i class="bi bi-info-circle"></i>
            How It Works
          </a>
        </div>
      </div>
      <div class="col-lg-6 animate-on-scroll animate-delay-3">
        <img
          src="{% static 'images/hero-image.jpeg' %}"
          alt="Home service professionals"
          class="img-fluid hero-image"
          onerror="this.src='/placeholder.svg?height=400&width=600'; this.onerror=null;"
        />
      </div>
    </div>
  </div>
</section>

<!-- Enhanced Categories Section -->
<section class="categories-section">
  <div class="container">
    <h2 class="section-title animate-on-scroll">Popular Service Categories</h2>
    <p class="section-subtitle animate-on-scroll animate-delay-1">
      Find the right professional for any job around your home
    </p>

    <div class="row g-4">
      {% for category in categories %}
      <div class="col-6 col-md-4 col-lg-3 animate-on-scroll animate-delay-{{ forloop.counter|add:1 }}">
        <a href="{% url 'jobs:job_list' %}?category={{ category.id }}" class="category-card d-block">
          <div class="card-body">
            <!-- Enhanced dynamic icons -->
            {% if 'plumb' in category.name.lower %}
            <i class="bi bi-droplet-fill category-icon"></i>
            {% elif 'electric' in category.name.lower %}
            <i class="bi bi-lightning-fill category-icon"></i>
            {% elif 'garden' in category.name.lower %}
            <i class="bi bi-flower1 category-icon"></i>
            {% elif 'clean' in category.name.lower %}
            <i class="bi bi-brush category-icon"></i>
            {% elif 'paint' in category.name.lower %}
            <i class="bi bi-palette-fill category-icon"></i>
            {% elif 'repair' in category.name.lower %}
            <i class="bi bi-tools category-icon"></i>
            {% elif 'cook' in category.name.lower or 'chef' in category.name.lower %}
            <i class="bi bi-egg-fried category-icon"></i>
            {% elif 'security' in category.name.lower %}
            <i class="bi bi-shield-check category-icon"></i>
            {% elif 'transport' in category.name.lower or 'driver' in category.name.lower %}
            <i class="bi bi-car-front category-icon"></i>
            {% elif 'tutor' in category.name.lower or 'teach' in category.name.lower %}
            <i class="bi bi-book category-icon"></i>
            {% else %}
            <i class="bi bi-house-gear-fill category-icon"></i>
            {% endif %}
            <h5 class="category-title">{{ category.name }}</h5>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Enhanced How It Works Section -->
<section id="how-it-works" class="how-it-works-section">
  <div class="container">
    <h2 class="section-title animate-on-scroll">How TrabahoLink Works</h2>
    <p class="section-subtitle animate-on-scroll animate-delay-1">
      Three simple steps to find the perfect professional
    </p>

    <div class="row g-4">
      <div class="col-md-4 animate-on-scroll animate-delay-2">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">1</div>
            <h4 class="step-title">Post Your Job</h4>
            <p class="step-description">
              Describe what you need done, when you need it, and your location.
              Be specific about your requirements to attract the right professionals.
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-4 animate-on-scroll animate-delay-3">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">2</div>
            <h4 class="step-title">Compare Offers</h4>
            <p class="step-description">
              Review profiles, ratings, and offers from interested
              professionals. Compare prices and read reviews to make the best choice.
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-4 animate-on-scroll animate-delay-4">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">3</div>
            <h4 class="step-title">Negotiate and Hire</h4>
            <p class="step-description">
              Choose the best match, negotiate terms, and hire securely through
              our platform. Get the job done with confidence.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Enhanced How to Apply Section -->
<section class="apply-section">
  <div class="container">
    <h2 class="section-title animate-on-scroll">How to Apply for a Job</h2>
    <p class="section-subtitle animate-on-scroll animate-delay-1">
      Follow these steps to apply and get hired quickly through TrabahoLink
    </p>

    <div class="row g-4">
      <div class="col-md-4 animate-on-scroll animate-delay-2">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">1</div>
            <h4 class="step-title">Browse Available Jobs</h4>
            <p class="step-description">
              Go to the job listings page and find a job that fits your skills and location.
              Use filters to narrow down your search.
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-4 animate-on-scroll animate-delay-3">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">2</div>
            <h4 class="step-title">Submit Your Application</h4>
            <p class="step-description">
              Click on a job to view details and use the apply button to submit your offer or message.
              Showcase your skills and experience.
            </p>
          </div>
        </div>
      </div>

      <div class="col-md-4 animate-on-scroll animate-delay-4">
        <div class="step-card">
          <div class="card-body">
            <div class="step-number">3</div>
            <h4 class="step-title">Get Hired</h4>
            <p class="step-description">
              Wait for the job poster to review your application and accept your offer. 
              Communicate professionally and complete the job successfully.
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Enhanced CTA Section -->
<section class="cta-section">
  <div class="container text-center">
    <h2 class="cta-title animate-on-scroll">Ready to Get Started?</h2>
    <p class="cta-subtitle animate-on-scroll animate-delay-1">
      Join thousands of homeowners who have found reliable professionals through
      TrabahoLink
    </p>
    <div class="d-flex justify-content-center gap-3 animate-on-scroll animate-delay-2">
      <a href="{% url 'jobs:job_list' %}" class="btn btn-light btn-lg">
        <i class="bi bi-search"></i>
        Find a Professional
      </a>
      {% if user.is_authenticated %}
      <a href="{% url 'jobs:job_create' %}" class="btn btn-outline-light btn-lg">
        <i class="bi bi-plus-circle"></i>
        Post a Job
      </a>
      {% else %}
      <a href="{% url 'login' %}?next={% url 'jobs:job_create' %}" class="btn btn-outline-light btn-lg">
        <i class="bi bi-plus-circle"></i>
        Post a Job
      </a>
      {% endif %}
    </div>
  </div>
</section>

<!-- Add Bootstrap Icons if not already included in your base template -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
/>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Intersection Observer for scroll animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.animation = entry.target.style.animation.replace('paused', 'running');
            }
        });
    }, observerOptions);

    // Observe all elements with animate-on-scroll class
    document.querySelectorAll('.animate-on-scroll').forEach(el => {
        el.style.animationPlayState = 'paused';
        observer.observe(el);
    });

    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Add loading states for buttons
    document.querySelectorAll('.btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (this.href && !this.href.includes('#')) {
                const originalContent = this.innerHTML;
                this.innerHTML = '<i class="bi bi-arrow-clockwise" style="animation: spin 1s linear infinite;"></i> Loading...';
                this.disabled = true;
                
                // Re-enable after a delay (in case of navigation issues)
                setTimeout(() => {
                    this.innerHTML = originalContent;
                    this.disabled = false;
                }, 3000);
            }
        });
    });

    // Add CSS for spin animation
    const style = document.createElement('style');
    style.textContent = `
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);

    // Parallax effect for hero section
    window.addEventListener('scroll', function() {
        const scrolled = window.pageYOffset;
        const heroSection = document.querySelector('.hero-section');
        if (heroSection) {
            const rate = scrolled * -0.5;
            heroSection.style.transform = `translateY(${rate}px)`;
        }
    });

    // Add hover effects for category cards
    document.querySelectorAll('.category-card').forEach(card => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-8px) scale(1.02)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
        });
    });

    // Add counter animation for step numbers
    function animateCounters() {
        document.querySelectorAll('.step-number').forEach(counter => {
            const target = parseInt(counter.textContent);
            let current = 0;
            const increment = target / 20;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    counter.textContent = target;
                    clearInterval(timer);
                } else {
                    counter.textContent = Math.floor(current);
                }
            }, 50);
        });
    }

    // Trigger counter animation when step cards come into view
    const stepObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                animateCounters();
                stepObserver.unobserve(entry.target);
            }
        });
    }, { threshold: 0.5 });

    document.querySelectorAll('.step-card').forEach(card => {
        stepObserver.observe(card);
    });
});
</script>
{% endblock %}